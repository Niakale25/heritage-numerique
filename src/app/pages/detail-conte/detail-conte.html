<main class="main-content-reader">
  <!-- ÉTAT : Chargement -->
  <ng-container *ngIf="isLoading(); else loadedOrError">
    <div class="reader-container text-center p-10">
      <h2>Chargement du conte...</h2>
    </div>
  </ng-container>

  <!-- ÉTAT : Chargé -->
  <ng-template #loadedOrError>
    <ng-container *ngIf="conteDetails(); else errorState">
      <div class="reader-container">
        <!-- RETOUR -->
        <div class="back-arrow-container" [routerLink]="['/accueil/conte']">
          <i class="material-icons back-arrow">arrow_back</i>
        </div>

        <!-- TITRE -->
        <h1 class="story-title">{{ conteDetails()!.titre }}</h1>

        <!-- SÉLECTEUR DE LANGUE -->
        <div class="language-selector-container">
          <select class="language-select">
            <option selected>Bambara</option>
            <option>Français</option>
            <option>Anglais</option>
          </select>
          <i class="material-icons select-arrow">keyboard_arrow_down</i>
        </div>

        <!-- IMAGE + PLAYER -->
        <div class="media-player-card">
          <img
            [src]="getThumbnailUrl(conteDetails()!.urlPhoto)"
            [alt]="'Image du conte ' + conteDetails()!.titre"
            class="media-image"
          />

          <div class="media-controls">
            <div class="play-button">
              <i class="material-icons play-icon">play_arrow</i>
            </div>

            <div class="progress-section">
              <span class="audio-time">3:45</span>
              <div class="progress-bar-container">
                <div class="progress-bar" style="width: 40%"></div>
              </div>
            </div>
          </div>
        </div>

        <!-- TEXTE DU CONTE -->
        <div class="content-card">
          <p class="story-text">{{ conteDetails()!.description }}</p>

          <p class="story-author mt-4 text-right text-gray-500 font-medium">
            — Raconté par {{ conteDetails()!.nomCreateur }}
          </p>
        </div>
      </div>
    </ng-container>

    <!-- ÉTAT : Erreur -->
    <ng-template #errorState>
      <div class="reader-container text-center p-8">
        <h1 class="story-title text-red-500">Erreur</h1>
        <p class="text-gray-600">{{ errorMessage() }}</p>
        <div class="back-arrow-container mt-4 mx-auto" [routerLink]="['/accueil/conte']">
          <button
            class="bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition"
          >
            Retour à la liste
          </button>
        </div>
      </div>
    </ng-template>
  </ng-template>
</main>
